<div class="statistics-page">
  <div class="page-header">
    <h1>Champion Statistics</h1>
    <p class="subtitle">Comprehensive champion performance analytics</p>
  </div>

  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Loading statistics...</p>
  </div>

  <div *ngIf="!loading" class="statistics-content">
    <!-- Filters Section -->
    <div class="filters-section">
      <div class="filters-header">
        <h3>Filters</h3>
        <button class="clear-btn" (click)="clearFilters()" *ngIf="selectedRole !== 'All' || selectedPosition !== 'All'">
          Clear All
        </button>
      </div>

      <div class="filters-grid">
        <!-- Role Filter -->
        <div class="filter-group">
          <label>Champion Role</label>
          <div class="role-filters">
            <button
              *ngFor="let role of roles"
              class="filter-btn"
              [class.active]="selectedRole === role"
              [style.border-color]="role !== 'All' ? getRoleColor(role) : '#3c3c41'"
              (click)="onRoleChange(role)">
              <span *ngIf="role !== 'All'" class="role-dot" [style.background-color]="getRoleColor(role)"></span>
              {{ role }}
            </button>
          </div>
        </div>

        <!-- Position Filter (Optional - uncomment when position stats are available) -->
        <!--
        <div class="filter-group">
          <label>Lane Position</label>
          <div class="position-filters">
            <button
              *ngFor="let position of positions"
              class="filter-btn"
              [class.active]="selectedPosition === position"
              (click)="onPositionChange(position)">
              <span *ngIf="position !== 'All'" class="position-icon">
                {{ championService.getPositionIcon(position) }}
              </span>
              {{ position }}
            </button>
          </div>
        </div>
        -->
      </div>

      <!-- Results Summary -->
      <div class="results-summary">
        <span class="results-count">{{ championStats.length }} champions</span>
        <span *ngIf="selectedRole !== 'All'" class="active-filter">
          Role: <strong>{{ selectedRole }}</strong>
        </span>
        <span *ngIf="selectedPosition !== 'All'" class="active-filter">
          Position: <strong>{{ selectedPosition }}</strong>
        </span>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-grid">
      <div class="chart-card">
        <app-chart
          *ngIf="championWinRateData"
          [type]="'bar'"
          [data]="championWinRateData"
          [title]="'Top 15 Champions - Win Rate'"
          [options]="{scales: {y: {beginAtZero: true, max: 100}}}">
        </app-chart>
      </div>

      <div class="chart-card">
        <app-chart
          *ngIf="championPickRateData"
          [type]="'bar'"
          [data]="championPickRateData"
          [title]="'Top 15 Champions - Pick Rate (Total Games)'">
        </app-chart>
      </div>

      <div class="chart-card">
        <app-chart
          *ngIf="championKDAData"
          [type]="'bar'"
          [data]="championKDAData"
          [title]="'Top 15 Champions - Average KDA'"
          [options]="{scales: {y: {beginAtZero: true}}}">
        </app-chart>
      </div>
    </div>

    <!-- Champion Stats Table -->
    <div class="stats-table-container">
      <h2>All Champion Statistics</h2>
      <div class="table-wrapper">
        <table class="stats-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Champion</th>
              <th>Role</th>
              <th>Games</th>
              <th>Wins</th>
              <th>Win Rate</th>
              <th>Avg K/D/A</th>
              <th>Avg KDA</th>
              <th>Avg Gold</th>
              <th>Avg Damage</th>
              <th>Avg CS</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let champ of championStats; let i = index">
              <td>{{ i + 1 }}</td>
              <td class="champion-name">{{ champ.champion }}</td>
              <td>
                <span class="role-badge" [style.background-color]="getRoleColor(champ.role)">
                  {{ champ.role }}
                </span>
              </td>
              <td>{{ champ.totalGames | number }}</td>
              <td>{{ champ.wins | number }}</td>
              <td class="win-rate" [class.high]="champ.winRate >= 52" [class.low]="champ.winRate < 48">
                {{ champ.winRate | number:'1.1-1' }}%
              </td>
              <td class="kda-stats">
                {{ champ.avgKills | number:'1.1-1' }} /
                {{ champ.avgDeaths | number:'1.1-1' }} /
                {{ champ.avgAssists | number:'1.1-1' }}
              </td>
              <td class="kda-ratio" [class.excellent]="champ.avgKDA >= 3" [class.good]="champ.avgKDA >= 2 && champ.avgKDA < 3">
                {{ champ.avgKDA | number:'1.2-2' }}
              </td>
              <td>{{ champ.avgGold / 1000 | number:'1.1-1' }}k</td>
              <td>{{ champ.avgDamage / 1000 | number:'1.1-1' }}k</td>
              <td>{{ champ.avgCS | number:'1.1-1' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
